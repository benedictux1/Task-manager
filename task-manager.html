<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Task Manager</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; }
    #root { height: 100vh; width: 100vw; }
    [contenteditable] h3 { font-size: 1.17em; font-weight: bold; margin: 0.83em 0; }
    [contenteditable] ul { list-style-type: disc; margin-left: 1.5em; }
    [contenteditable] ol { list-style-type: decimal; margin-left: 1.5em; }
    [contenteditable] strong { font-weight: 600; }
    [contenteditable] mark { background-color: #FFD93D; padding: 2px 4px; border-radius: 3px; }
    [contenteditable]:empty:before { content: attr(data-placeholder); color: #9CA3AF; }
  </style>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const { useState, useMemo, useRef } = React;
    
    // SVG Icons
    const Plus = () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M5 12h14M12 5v14"/></svg>;
    const Settings = () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="3"/><path d="M12 1v6m0 6v6m5.2-14.2l-4.2 4.2m-6 6l-4.2 4.2"/></svg>;
    const X = () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M18 6L6 18M6 6l12 12"/></svg>;
    const ChevronDown = () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="m6 9 6 6 6-6"/></svg>;
    const ChevronRight = () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="m9 18 6-6-6-6"/></svg>;
    const Bold = () => <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8"/></svg>;
    
    function TaskManagerApp() {
      const [currentView, setCurrentView] = useState('project');
      const [selectedProjectId, setSelectedProjectId] = useState(1);
      const [showSettings, setShowSettings] = useState(false);
      const [types, setTypes] = useState(['Admin', 'Urgent', 'Regular', 'Night', 'Weekend', 'Backlog', 'Others']);
      const [statuses, setStatuses] = useState([
        { name: 'Must do', color: '#FF6B6B' },
        { name: 'Waiting others', color: '#1D1D1F' },
        { name: 'My action', color: '#FFD93D' },
        { name: 'Done', color: '#6BCF7F' }
      ]);
      const [projects, setProjects] = useState([
        { id: 1, name: 'Website Redesign', notes: '<p>Modernize company website with new branding.</p><h3>Key objectives:</h3><ul><li>Improve mobile responsiveness</li><li>Update color scheme</li></ul>' },
        { id: 2, name: 'Q1 Planning', notes: '<p>Strategic planning for Q1 2026.</p>' }
      ]);
      const [tasks, setTasks] = useState([
        { id: 1, name: 'Review design mockups', projectId: 1, type: 'Urgent', status: 'Must do', dueDate: '1/25' },
        { id: 2, name: 'Update homepage copy', projectId: 1, type: 'Regular', status: 'My action', dueDate: '1/28' },
        { id: 3, name: 'Finalize Q1 OKRs', projectId: 2, type: 'Urgent', status: 'Must do', dueDate: '1/24' }
      ]);
      const [newTaskInput, setNewTaskInput] = useState('');

      const getStatusColor = (statusName) => statuses.find(s => s.name === statusName)?.color || '#1D1D1F';
      const addProject = () => {
        const newId = Math.max(...projects.map(p => p.id), 0) + 1;
        setProjects([...projects, { id: newId, name: 'New Project', notes: '' }]);
        setSelectedProjectId(newId);
      };
      const updateProject = (id, field, value) => setProjects(projects.map(p => p.id === id ? { ...p, [field]: value } : p));
      const addTask = (projectId) => {
        if (!newTaskInput.trim()) return;
        const newId = Math.max(...tasks.map(t => t.id), 0) + 1;
        setTasks([...tasks, { id: newId, name: newTaskInput, projectId, type: 'Regular', status: 'My action', dueDate: '' }]);
        setNewTaskInput('');
      };
      const updateTask = (id, field, value) => setTasks(tasks.map(t => t.id === id ? { ...t, [field]: value } : t));
      const toggleTaskDone = (id) => {
        const task = tasks.find(t => t.id === id);
        if (task) updateTask(id, 'status', task.status === 'Done' ? 'My action' : 'Done');
      };
      const deleteTask = (id) => setTasks(tasks.filter(t => t.id !== id));

      return (
        <div className="h-screen bg-[#F5F5F7] flex flex-col">
          <header className="bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between">
            <h1 className="text-2xl font-semibold text-[#1D1D1F]">Task Manager</h1>
            <div className="flex items-center gap-4">
              <div className="flex bg-[#F5F5F7] rounded-lg p-1">
                <button onClick={() => setCurrentView('project')} className={`px-4 py-2 rounded-md text-sm font-medium ${currentView === 'project' ? 'bg-white text-[#0066CC] shadow-sm' : 'text-gray-600'}`}>
                  Project View
                </button>
                <button onClick={() => setCurrentView('task')} className={`px-4 py-2 rounded-md text-sm font-medium ${currentView === 'task' ? 'bg-white text-[#0066CC] shadow-sm' : 'text-gray-600'}`}>
                  Task View
                </button>
              </div>
              <button onClick={() => setShowSettings(true)} className="p-2 hover:bg-[#F5F5F7] rounded-lg">
                <Settings />
              </button>
            </div>
          </header>
          
          {currentView === 'project' ? (
            <ProjectView {...{projects, selectedProjectId, setSelectedProjectId, addProject, updateProject, tasks, types, statuses, getStatusColor, addTask, updateTask, toggleTaskDone, deleteTask, newTaskInput, setNewTaskInput}} />
          ) : (
            <div className="flex-1 p-8 overflow-y-auto">
              <div className="max-w-6xl mx-auto bg-white rounded-xl p-6">
                <h2 className="text-2xl font-bold mb-6">All Tasks</h2>
                {tasks.map(task => {
                  const project = projects.find(p => p.id === task.projectId);
                  const statusColor = getStatusColor(task.status);
                  return (
                    <div key={task.id} className="flex items-center gap-4 p-4 border-b hover:bg-gray-50">
                      <input type="checkbox" checked={task.status === 'Done'} onChange={() => toggleTaskDone(task.id)} className="w-5 h-5" style={{accentColor: statusColor}} />
                      <span className={task.status === 'Done' ? 'line-through text-gray-400 flex-1' : 'flex-1'}>{task.name}</span>
                      <span className="px-3 py-1 text-xs rounded-full bg-blue-100 text-blue-700">{project?.name}</span>
                      <span className="px-3 py-1 text-xs rounded-lg text-white" style={{backgroundColor: statusColor}}>{task.status}</span>
                    </div>
                  );
                })}
              </div>
            </div>
          )}
          
          {showSettings && <SettingsModal {...{types, setTypes, statuses, setStatuses, onClose: () => setShowSettings(false)}} />}
        </div>
      );
    }

    function ProjectView({projects, selectedProjectId, setSelectedProjectId, addProject, updateProject, tasks, types, statuses, getStatusColor, addTask, updateTask, toggleTaskDone, deleteTask, newTaskInput, setNewTaskInput}) {
      const [sidebarVisible, setSidebarVisible] = useState(false);
      const selectedProject = projects.find(p => p.id === selectedProjectId);
      const projectTasks = tasks.filter(t => t.projectId === selectedProjectId);
      
      return (
        <div className="flex-1 flex overflow-hidden relative">
          <div className="absolute left-0 top-0 bottom-0 w-2 z-30" onMouseEnter={() => setSidebarVisible(true)} />
          <aside className={`absolute left-0 top-0 bottom-0 w-64 bg-white border-r border-gray-200 z-40 transition-transform duration-200 ${sidebarVisible ? 'translate-x-0' : '-translate-x-full'}`} onMouseLeave={() => setSidebarVisible(false)}>
            <div className="p-4 border-b flex items-center justify-between">
              <h2 className="font-semibold">Projects</h2>
              <button onClick={addProject} className="p-1 hover:bg-gray-100 rounded"><Plus /></button>
            </div>
            <nav className="p-2">
              {projects.map(p => (
                <button key={p.id} onClick={() => setSelectedProjectId(p.id)} className={`w-full text-left px-3 py-2 rounded-lg text-sm ${selectedProjectId === p.id ? 'bg-[#0066CC] text-white' : 'hover:bg-gray-100'}`}>
                  {p.name}
                </button>
              ))}
            </nav>
          </aside>
          
          <main className="flex-1 overflow-y-auto p-8">
            <div className="max-w-4xl mx-auto">
              <input type="text" value={selectedProject?.name || ''} onChange={(e) => updateProject(selectedProjectId, 'name', e.target.value)} className="text-4xl font-bold bg-transparent border-none outline-none w-full mb-8" placeholder="Project Name" />
              
              <div className="mb-8">
                <h3 className="text-xl font-semibold mb-4">Tasks</h3>
                {projectTasks.map(task => {
                  const statusColor = getStatusColor(task.status);
                  return (
                    <div key={task.id} className="flex items-center gap-3 p-4 bg-white rounded-lg border mb-2">
                      <input type="checkbox" checked={task.status === 'Done'} onChange={() => toggleTaskDone(task.id)} className="w-5 h-5" style={{accentColor: statusColor}} />
                      <span className={`flex-1 ${task.status === 'Done' ? 'line-through text-gray-400' : ''}`}>{task.name}</span>
                      <select value={task.type} onChange={(e) => updateTask(task.id, 'type', e.target.value)} className="px-3 py-1 bg-gray-100 rounded">
                        {types.map(t => <option key={t}>{t}</option>)}
                      </select>
                      <span className="px-3 py-1 rounded-lg text-white text-sm" style={{backgroundColor: statusColor}}>{task.status}</span>
                      {task.dueDate && <span className="text-sm text-gray-500">{task.dueDate}</span>}
                      <button onClick={() => deleteTask(task.id)} className="text-red-500 hover:bg-red-50 p-1 rounded"><X /></button>
                    </div>
                  );
                })}
                <div className="flex gap-2 mt-4">
                  <input type="text" value={newTaskInput} onChange={(e) => setNewTaskInput(e.target.value)} onKeyPress={(e) => e.key === 'Enter' && addTask(selectedProjectId)} placeholder="Add a new task..." className="flex-1 px-4 py-3 bg-white rounded-lg border" />
                  <button onClick={() => addTask(selectedProjectId)} className="px-6 py-3 bg-[#0066CC] text-white rounded-lg font-medium">Add Task</button>
                </div>
              </div>
              
              <div>
                <h3 className="text-xl font-semibold mb-4">Notes</h3>
                <div contentEditable dangerouslySetInnerHTML={{__html: selectedProject?.notes || ''}} onInput={(e) => updateProject(selectedProjectId, 'notes', e.currentTarget.innerHTML)} className="min-h-[200px] p-4 outline-none" data-placeholder="Add project notes..." />
              </div>
            </div>
          </main>
        </div>
      );
    }

    function SettingsModal({types, setTypes, statuses, setStatuses, onClose}) {
      const [newType, setNewType] = useState('');
      return (
        <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4">
          <div className="bg-white rounded-xl w-full max-w-2xl p-6">
            <div className="flex justify-between mb-6">
              <h2 className="text-2xl font-semibold">Settings</h2>
              <button onClick={onClose} className="p-2 hover:bg-gray-100 rounded"><X /></button>
            </div>
            <div className="space-y-6">
              <div>
                <h3 className="font-semibold mb-3">Task Types</h3>
                {types.map(t => (
                  <div key={t} className="flex justify-between p-2 bg-gray-100 rounded mb-2">
                    <span>{t}</span>
                    <button onClick={() => setTypes(types.filter(x => x !== t))} className="text-red-500"><X /></button>
                  </div>
                ))}
                <div className="flex gap-2 mt-3">
                  <input type="text" value={newType} onChange={(e) => setNewType(e.target.value)} placeholder="New type..." className="flex-1 px-3 py-2 border rounded" />
                  <button onClick={() => { if(newType.trim()) { setTypes([...types, newType.trim()]); setNewType(''); }}} className="px-4 py-2 bg-[#0066CC] text-white rounded">Add</button>
                </div>
              </div>
              <div>
                <h3 className="font-semibold mb-3">Task Statuses</h3>
                {statuses.map(s => (
                  <div key={s.name} className="flex items-center gap-3 p-2 bg-gray-100 rounded mb-2">
                    <input type="color" value={s.color} onChange={(e) => setStatuses(statuses.map(x => x.name === s.name ? {...x, color: e.target.value} : x))} className="w-10 h-10 rounded" />
                    <span className="flex-1">{s.name}</span>
                    <button onClick={() => setStatuses(statuses.filter(x => x.name !== s.name))} className="text-red-500"><X /></button>
                  </div>
                ))}
              </div>
            </div>
            <button onClick={onClose} className="mt-6 w-full py-2 bg-[#0066CC] text-white rounded-lg">Done</button>
          </div>
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById('root')).render(<TaskManagerApp />);
  </script>
</body>
</html>
